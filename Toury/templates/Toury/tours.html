{% extends 'Toury/base.html' %}
{% block title %}Tours{% endblock %}
{% block extrascripts %}
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC5zT8GT1qKus12TlMBWfl9Fz8jjta3W9s&sensor=true"></script>
    <script type="text/javascript">
      var map;
      $(function(){

        var mapOptions;
        var marker = new google.maps.Marker();
        var infowindow;
        map = new google.maps.Map(document.getElementById("map-canvas"));
        google.maps.event.addListener(map, 'click', function(event){
            $('#lat').val(event.latLng.lat());
            $('#lng').val(event.latLng.lng());
            if(marker != null)
            marker.setMap(null);
            marker = new google.maps.Marker({
                map: map,
                position: event.latLng,
                title: 'New Marker'
            });

            google.maps.event.addListener(marker, 'click', function(event){
                infowindow.open(map, marker);
            });

            infowindow = new google.maps.InfoWindow({
                content: '<div id="content">'+
                    '<h3 class="firstHeading" id="firstHeading">New Marker</h3>'+
                    '</div>'+
                    '</div>'
            });
            infowindow.open(map, marker);
        });



        if (navigator.geolocation)
        {
            navigator.geolocation.getCurrentPosition(setLoc);

        } else {
            mapOptions = {
                center: new google.maps.LatLng(-34.397, 150.644),
                zoom: 8
            };
            map.setOptions(mapOptions);
        }
      });

      function setLoc(location)
      {
           //console.log(location.coords.latitude);
           mapOptions = {
                center: new google.maps.LatLng(location.coords.latitude, location.coords.longitude),
                zoom: 14
            }
            map.setOptions(mapOptions);
      }

    </script>
{% endblock %}
{% block style %}
<style type="text/css">
    html { height: 100% }
    body { height: 100%; margin: 0; padding: 0 }
    #map-canvas { margin-top: 20px; height: 400px; width: 100%;}
</style>
{% endblock %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <div id="map-canvas"></div>
            </div>
            <div class="col-md-4">
                <form role="form" action="/add" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="marker">Marker:</label>
                        <input type="text" class="form-control" id="marker" name="title" placeholder="Enter marker title">
                    </div>
                    <div class="form-group">
                        <label for="description">Description:</label>
                        <textarea rows="10" cols="80" class="form-control" id="description" name='description' placeholder="Description"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="lat">Latitude:</label>
                        <input type="text" class="form-control" id="lat" name="latitude" placeholder="">
                    </div>
                    <div class="form-group">
                        <label for="lng">Longitude:</label>
                        <input type="text" class="form-control" id="lng" name="longitude" placeholder="">
                    </div>
                  <button type="submit" class="btn btn-default">Submit</button>
                </form>
            </div>
        </div>
    </div>

{% endblock %}